{"version":3,"file":"rd-rich-value-types-xform.js","names":["XmlStream","require","BaseXform","RdRichValueTypesXform","render","xmlStream","openXml","StdDocAttributes","openNode","xmlns","keys","forEach","name","leafNode","value","closeNode","module","exports"],"sources":["../../../../../lib/xlsx/xform/richvalue/rd-rich-value-types-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\nconst BaseXform = require('../base-xform');\n\nclass RdRichValueTypesXform extends BaseXform {\n  render(xmlStream) {\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n    xmlStream.openNode('rvTypesInfo', {\n      xmlns: 'http://schemas.microsoft.com/office/spreadsheetml/2017/richdata2',\n      'xmlns:mc': 'http://schemas.openxmlformats.org/markup-compatibility/2006',\n      'mc:Ignorable': 'x',\n      'xmlns:x': 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n    });\n\n    xmlStream.openNode('global');\n    xmlStream.openNode('keyFlags');\n\n    const keys = [\n      '_Self',\n      '_DisplayString',\n      '_Flags',\n      '_Format',\n      '_SubLabel',\n      '_Attribution',\n      '_Icon',\n      '_Display',\n      '_CanonicalPropertyNames',\n      '_ClassificationId',\n    ];\n\n    keys.forEach(name => {\n      xmlStream.openNode('key', {name});\n      if (name === '_Self') {\n        xmlStream.leafNode('flag', {name: 'ExcludeFromFile', value: 1});\n      }\n      xmlStream.leafNode('flag', {name: 'ExcludeFromCalcComparison', value: 1});\n      xmlStream.closeNode(); // key\n    });\n\n    xmlStream.closeNode(); // keyFlags\n    xmlStream.closeNode(); // global\n    xmlStream.closeNode(); // rvTypesInfo\n  }\n}\n\nmodule.exports = RdRichValueTypesXform;\n"],"mappings":";;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AACtD,MAAMC,SAAS,GAAGD,OAAO,CAAC,eAAe,CAAC;AAE1C,MAAME,qBAAqB,SAASD,SAAS,CAAC;EAC5CE,MAAMA,CAACC,SAAS,EAAE;IAChBA,SAAS,CAACC,OAAO,CAACN,SAAS,CAACO,gBAAgB,CAAC;IAC7CF,SAAS,CAACG,QAAQ,CAAC,aAAa,EAAE;MAChCC,KAAK,EAAE,kEAAkE;MACzE,UAAU,EAAE,6DAA6D;MACzE,cAAc,EAAE,GAAG;MACnB,SAAS,EAAE;IACb,CAAC,CAAC;IAEFJ,SAAS,CAACG,QAAQ,CAAC,QAAQ,CAAC;IAC5BH,SAAS,CAACG,QAAQ,CAAC,UAAU,CAAC;IAE9B,MAAME,IAAI,GAAG,CACX,OAAO,EACP,gBAAgB,EAChB,QAAQ,EACR,SAAS,EACT,WAAW,EACX,cAAc,EACd,OAAO,EACP,UAAU,EACV,yBAAyB,EACzB,mBAAmB,CACpB;IAEDA,IAAI,CAACC,OAAO,CAACC,IAAI,IAAI;MACnBP,SAAS,CAACG,QAAQ,CAAC,KAAK,EAAE;QAACI;MAAI,CAAC,CAAC;MACjC,IAAIA,IAAI,KAAK,OAAO,EAAE;QACpBP,SAAS,CAACQ,QAAQ,CAAC,MAAM,EAAE;UAACD,IAAI,EAAE,iBAAiB;UAAEE,KAAK,EAAE;QAAC,CAAC,CAAC;MACjE;MACAT,SAAS,CAACQ,QAAQ,CAAC,MAAM,EAAE;QAACD,IAAI,EAAE,2BAA2B;QAAEE,KAAK,EAAE;MAAC,CAAC,CAAC;MACzET,SAAS,CAACU,SAAS,CAAC,CAAC,CAAC,CAAC;IACzB,CAAC,CAAC;IAEFV,SAAS,CAACU,SAAS,CAAC,CAAC,CAAC,CAAC;IACvBV,SAAS,CAACU,SAAS,CAAC,CAAC,CAAC,CAAC;IACvBV,SAAS,CAACU,SAAS,CAAC,CAAC,CAAC,CAAC;EACzB;AACF;AAEAC,MAAM,CAACC,OAAO,GAAGd,qBAAqB","ignoreList":[]}